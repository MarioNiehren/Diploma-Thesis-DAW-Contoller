<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Diploma Thesis DAW-Controller: Button Matrix: Header</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="mdw_Logo_weiss.jpg"/></td>
  <td id="projectalign">
   <div id="projectname">Diploma Thesis DAW-Controller: Button Matrix<span id="projectnumber">&#160;Demo Project</span>
   </div>
   <div id="projectbrief">This Project shows how to setup and use a button matrix.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('group___t_s_c_button___header.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a>  </div>
  <div class="headertitle"><div class="title">Header<div class="ingroups"><a class="el" href="group___motor_fader.html">Motorized Fader</a> &raquo; <a class="el" href="group___t_s_c_button.html">TSC Button</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Study this part for a quick overview of this module.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_t_s_c_button__struct_td.html">TSCButton_structTd</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga27e7a39708aaad9c8cb83bacdab6319a" id="r_ga27e7a39708aaad9c8cb83bacdab6319a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga27e7a39708aaad9c8cb83bacdab6319a">NUM_TSC_GROUPS</a>&#160;&#160;&#160;8</td></tr>
<tr class="memdesc:ga27e7a39708aaad9c8cb83bacdab6319a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This define represents the max number of TSC-Groups. Change, if the used MCU offers a different number of TSC Groups.  <br /></td></tr>
<tr class="separator:ga27e7a39708aaad9c8cb83bacdab6319a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab3380574495c7ed825cf4a137af997ac" id="r_gab3380574495c7ed825cf4a137af997ac"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gab3380574495c7ed825cf4a137af997ac">NUM_FREE_IOS</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:gab3380574495c7ed825cf4a137af997ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaedd068d5321f0e7868e86c289b96e62" id="r_gaaedd068d5321f0e7868e86c289b96e62"><td class="memItemLeft" align="right" valign="top"><a id="gaaedd068d5321f0e7868e86c289b96e62" name="gaaedd068d5321f0e7868e86c289b96e62"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MAX_TSC_BUTTONS</b>&#160;&#160;&#160;(<a class="el" href="#ga27e7a39708aaad9c8cb83bacdab6319a">NUM_TSC_GROUPS</a> * <a class="el" href="#gab3380574495c7ed825cf4a137af997ac">NUM_FREE_IOS</a>)</td></tr>
<tr class="separator:gaaedd068d5321f0e7868e86c289b96e62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga90dc25b901f609dad85bc9ac4c96ef3d" id="r_ga90dc25b901f609dad85bc9ac4c96ef3d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga90dc25b901f609dad85bc9ac4c96ef3d">TSC_NUM_SAMPLES</a>&#160;&#160;&#160;50</td></tr>
<tr class="separator:ga90dc25b901f609dad85bc9ac4c96ef3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader">Structures and Enumerations</h2></td></tr>
<tr class="memitem:ga4848acc9d4a5ef047a2a1732d51c95b6" id="r_ga4848acc9d4a5ef047a2a1732d51c95b6"><td class="memItemLeft" align="right" valign="top"><a id="ga4848acc9d4a5ef047a2a1732d51c95b6" name="ga4848acc9d4a5ef047a2a1732d51c95b6"></a>enum &#160;</td><td class="memItemRight" valign="bottom"><b>TSCButton_State_enumTd</b> { <b>TSCBUTTON_TOUCHED</b> = 1
, <b>TSCBUTTON_RELEASED</b> = 0
 }</td></tr>
<tr class="separator:ga4848acc9d4a5ef047a2a1732d51c95b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader">Initialize</h2></td></tr>
<tr><td class="ititle" colspan="2"><p>Use these functions to initialize the touch sense controller based button. </p>
</td></tr>
<tr class="memitem:gadea3910a50802013c61688c34af42b2a" id="r_gadea3910a50802013c61688c34af42b2a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gadea3910a50802013c61688c34af42b2a">TSCButton_init_TSC</a> (<a class="el" href="struct_t_s_c_button__struct_td.html">TSCButton_structTd</a> *tsc, TSC_HandleTypeDef *htsc, uint32_t IOChannel)</td></tr>
<tr class="memdesc:gadea3910a50802013c61688c34af42b2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Link the htsc handler to this module and specify the IO Channel. All Buttons have to be initialized before starting TSC. If you add buttons while TSC is running, internal counters might get confused and crash the program.  <br /></td></tr>
<tr class="separator:gadea3910a50802013c61688c34af42b2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac563acc8b2838373da3cf6dee8127810" id="r_gac563acc8b2838373da3cf6dee8127810"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gac563acc8b2838373da3cf6dee8127810">TSCButton_init_Threshold</a> (<a class="el" href="struct_t_s_c_button__struct_td.html">TSCButton_structTd</a> *tsc, uint16_t value)</td></tr>
<tr class="memdesc:gac563acc8b2838373da3cf6dee8127810"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup the threshold where the TSC button will toggle between touched and released.  <br /></td></tr>
<tr class="separator:gac563acc8b2838373da3cf6dee8127810"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf706cac3ee0be2f3f1770d87953f2c03" id="r_gaf706cac3ee0be2f3f1770d87953f2c03"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaf706cac3ee0be2f3f1770d87953f2c03">TSCButton_init_DischargeTimeMsAll</a> (uint8_t value)</td></tr>
<tr class="memdesc:gaf706cac3ee0be2f3f1770d87953f2c03"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup the discharge time in ms, that is required to discharge the sensing capacitor. Depending on the used capacitor, 1ms may be enough.  <br /></td></tr>
<tr class="separator:gaf706cac3ee0be2f3f1770d87953f2c03"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader">Process TSC</h2></td></tr>
<tr><td class="ititle" colspan="2"><p>Use these functions to control the TSC for all buttons </p>
</td></tr>
<tr class="memitem:ga503e1c587002f993ecfb62f6ad0209e4" id="r_ga503e1c587002f993ecfb62f6ad0209e4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga503e1c587002f993ecfb62f6ad0209e4">TSCButton_start_All</a> (void)</td></tr>
<tr class="memdesc:ga503e1c587002f993ecfb62f6ad0209e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function sets the module to start conditions.  <br /></td></tr>
<tr class="separator:ga503e1c587002f993ecfb62f6ad0209e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad583fc1b4a691826653bcb2dd5d52278" id="r_gad583fc1b4a691826653bcb2dd5d52278"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gad583fc1b4a691826653bcb2dd5d52278">TSCButton_update_All</a> (void)</td></tr>
<tr class="memdesc:gad583fc1b4a691826653bcb2dd5d52278"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the TSC for all buttons. Calöl this funciton periodically in the main while loop.  <br /></td></tr>
<tr class="separator:gad583fc1b4a691826653bcb2dd5d52278"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9a0bf2ea0b4d926c1ae1724ae86b24fc" id="r_ga9a0bf2ea0b4d926c1ae1724ae86b24fc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga9a0bf2ea0b4d926c1ae1724ae86b24fc">TSCButton_manage_Interrupt</a> (void)</td></tr>
<tr class="memdesc:ga9a0bf2ea0b4d926c1ae1724ae86b24fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Call this function in the HAL-Interrupt handler to set an internal interrupt flag for the TSC module.  <br /></td></tr>
<tr class="separator:ga9a0bf2ea0b4d926c1ae1724ae86b24fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader">Get Functions</h2></td></tr>
<tr><td class="ititle" colspan="2"><p>Use these functions to get values for the TSC-Buttons </p>
</td></tr>
<tr class="memitem:ga7e38c54496d42ef7c41976a83607771f" id="r_ga7e38c54496d42ef7c41976a83607771f"><td class="memItemLeft" align="right" valign="top">TSCButton_State_enumTd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga7e38c54496d42ef7c41976a83607771f">TSCButton_get_State</a> (<a class="el" href="struct_t_s_c_button__struct_td.html">TSCButton_structTd</a> *tsc)</td></tr>
<tr class="memdesc:ga7e38c54496d42ef7c41976a83607771f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Call this function to get the current state of a TSC-Button.  <br /></td></tr>
<tr class="separator:ga7e38c54496d42ef7c41976a83607771f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0d1e776091a3e9e11271ce42b3d75fc3" id="r_ga0d1e776091a3e9e11271ce42b3d75fc3"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga0d1e776091a3e9e11271ce42b3d75fc3">TSCButton_get_RawValue</a> (<a class="el" href="struct_t_s_c_button__struct_td.html">TSCButton_structTd</a> *tsc)</td></tr>
<tr class="memdesc:ga0d1e776091a3e9e11271ce42b3d75fc3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Call this function to get the current raw TSC value of a Button.  <br /></td></tr>
<tr class="separator:ga0d1e776091a3e9e11271ce42b3d75fc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga235992141af696bf45579dd8f8604596" id="r_ga235992141af696bf45579dd8f8604596"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga235992141af696bf45579dd8f8604596">TSCButton_get_SmoothValue</a> (<a class="el" href="struct_t_s_c_button__struct_td.html">TSCButton_structTd</a> *tsc)</td></tr>
<tr class="memdesc:ga235992141af696bf45579dd8f8604596"><td class="mdescLeft">&#160;</td><td class="mdescRight">Call this function to get the current smooth TSC value of a Button.  <br /></td></tr>
<tr class="separator:ga235992141af696bf45579dd8f8604596"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Study this part for a quick overview of this module. </p>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="gab3380574495c7ed825cf4a137af997ac" name="gab3380574495c7ed825cf4a137af997ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab3380574495c7ed825cf4a137af997ac">&#9670;&#160;</a></span>NUM_FREE_IOS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NUM_FREE_IOS&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>3 because 1 is used by sampling capacitor. </p>

</div>
</div>
<a id="ga27e7a39708aaad9c8cb83bacdab6319a" name="ga27e7a39708aaad9c8cb83bacdab6319a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga27e7a39708aaad9c8cb83bacdab6319a">&#9670;&#160;</a></span>NUM_TSC_GROUPS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NUM_TSC_GROUPS&#160;&#160;&#160;8</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This define represents the max number of TSC-Groups. Change, if the used MCU offers a different number of TSC Groups. </p>
<p>Number of available TSC groups </p>

</div>
</div>
<a id="ga90dc25b901f609dad85bc9ac4c96ef3d" name="ga90dc25b901f609dad85bc9ac4c96ef3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga90dc25b901f609dad85bc9ac4c96ef3d">&#9670;&#160;</a></span>TSC_NUM_SAMPLES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TSC_NUM_SAMPLES&#160;&#160;&#160;50</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Number of values stored to calculate a smooth value </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga0d1e776091a3e9e11271ce42b3d75fc3" name="ga0d1e776091a3e9e11271ce42b3d75fc3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0d1e776091a3e9e11271ce42b3d75fc3">&#9670;&#160;</a></span>TSCButton_get_RawValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t TSCButton_get_RawValue </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_s_c_button__struct_td.html">TSCButton_structTd</a> *</td>          <td class="paramname"><span class="paramname"><em>tsc</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Call this function to get the current raw TSC value of a Button. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tsc</td><td>pointer to the users tsc structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>value of the last TSC measurement for this tsc structure </dd></dl>

</div>
</div>
<a id="ga235992141af696bf45579dd8f8604596" name="ga235992141af696bf45579dd8f8604596"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga235992141af696bf45579dd8f8604596">&#9670;&#160;</a></span>TSCButton_get_SmoothValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t TSCButton_get_SmoothValue </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_s_c_button__struct_td.html">TSCButton_structTd</a> *</td>          <td class="paramname"><span class="paramname"><em>tsc</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Call this function to get the current smooth TSC value of a Button. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tsc</td><td>pointer to the users tsc structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>value of the last TSC measurement for this tsc structure </dd></dl>

</div>
</div>
<a id="ga7e38c54496d42ef7c41976a83607771f" name="ga7e38c54496d42ef7c41976a83607771f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7e38c54496d42ef7c41976a83607771f">&#9670;&#160;</a></span>TSCButton_get_State()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TSCButton_State_enumTd TSCButton_get_State </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_s_c_button__struct_td.html">TSCButton_structTd</a> *</td>          <td class="paramname"><span class="paramname"><em>tsc</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Call this function to get the current state of a TSC-Button. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tsc</td><td>pointer to the users tsc structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>state of the tsc structure. </dd></dl>

</div>
</div>
<a id="gaf706cac3ee0be2f3f1770d87953f2c03" name="gaf706cac3ee0be2f3f1770d87953f2c03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf706cac3ee0be2f3f1770d87953f2c03">&#9670;&#160;</a></span>TSCButton_init_DischargeTimeMsAll()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TSCButton_init_DischargeTimeMsAll </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>value</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Setup the discharge time in ms, that is required to discharge the sensing capacitor. Depending on the used capacitor, 1ms may be enough. </p>
<dl class="section note"><dt>Note</dt><dd>Only setup this value once for all TSC Keys! Adapt the value to the slowest sampling capacitor. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">value</td><td>of the discharge time </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none </dd></dl>
<p>1. save the capacitor discharge time</p>

</div>
</div>
<a id="gac563acc8b2838373da3cf6dee8127810" name="gac563acc8b2838373da3cf6dee8127810"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac563acc8b2838373da3cf6dee8127810">&#9670;&#160;</a></span>TSCButton_init_Threshold()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TSCButton_init_Threshold </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_s_c_button__struct_td.html">TSCButton_structTd</a> *</td>          <td class="paramname"><span class="paramname"><em>tsc</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t</td>          <td class="paramname"><span class="paramname"><em>value</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Setup the threshold where the TSC button will toggle between touched and released. </p>
<dl class="section note"><dt>Note</dt><dd>How to evaluate a proper value:<ol type="1">
<li>Let the TSC button run without a threshold</li>
<li>read the raw value (e.g. with live expression) and look what the values are when touched and when released.</li>
<li>Choose a value in between and set it up as threshold. Tip: If the value difference is so small, that noise and environment changes overlap, increase the Charge Transfer High/Low Pulse Length. This will increase the value range from touched to released. </li>
</ol>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tsc</td><td>pointer to the users tsc structure </td></tr>
    <tr><td class="paramname">value</td><td>of the threshold </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none </dd></dl>
<p>1. save threshold value for the tsc to change state</p>

</div>
</div>
<a id="gadea3910a50802013c61688c34af42b2a" name="gadea3910a50802013c61688c34af42b2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadea3910a50802013c61688c34af42b2a">&#9670;&#160;</a></span>TSCButton_init_TSC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TSCButton_init_TSC </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_s_c_button__struct_td.html">TSCButton_structTd</a> *</td>          <td class="paramname"><span class="paramname"><em>tsc</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TSC_HandleTypeDef *</td>          <td class="paramname"><span class="paramname"><em>htsc</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>IOChannel</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Link the htsc handler to this module and specify the IO Channel. All Buttons have to be initialized before starting TSC. If you add buttons while TSC is running, internal counters might get confused and crash the program. </p>
<h1><a class="anchor" id="autotoc_md29"></a>
How to setup TSC in Cube MX (Values used for testing):</h1>
<ul>
<li>For each used group:<ul>
<li>Setup 1 sample capacitor</li>
<li>Setup 1 to 3 TSC Lines</li>
</ul>
</li>
<li>Parameter Settings:<ul>
<li>Charge Transfer High/Low Pulse Length: 6 Cycles (Other sized do work, but with shorter cycles the values get very close to each other when touched and released, what makes it difficult to get accurate touched or released detection. Larger values might be too slow for some use cases.)</li>
<li>Speed Spectrum: Disable</li>
<li>Pulse Generator Prescaler: Synchronous clock divided by 4 (tested with HCLK: 32MHz)</li>
<li>Maximum Count Value: 8191 charge transfer cycles</li>
<li>IO Default Mode: Output push-pull low</li>
<li>Acquisition Mode: Normal acquisition mode</li>
<li>Maximum Count Interrupt: Disable</li>
</ul>
</li>
<li>NVIC Settings:<ul>
<li>Touch sense controller interrupt: Enabled</li>
</ul>
</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tsc</td><td>pointer to the users tsc structure </td></tr>
    <tr><td class="paramname">htsc</td><td>pointer to the HAL generated TSC-handle of the TSC that is used for the button </td></tr>
    <tr><td class="paramname">IOChannel</td><td>channel of the TSC-Group used for this button. Please use the HAL defines that contain the proper register values. This is the naming convention: TSC_GROUPx_IOx. You can find the active channels in the htsc initialization in MX_TSC_init(). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none </dd></dl>
<p>1. link HAL generated tsc handler (htsc)</p>
<p>2. Copy configuration settings from htsc to TSC_IOConfigTypeDef ioConfigTsc. This is necessary for the use of some HAL TSC functions.</p>
<p>3. Extract group number from IOChannel and save it</p>
<p>4. link button structure to the internal structure</p>

</div>
</div>
<a id="ga9a0bf2ea0b4d926c1ae1724ae86b24fc" name="ga9a0bf2ea0b4d926c1ae1724ae86b24fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9a0bf2ea0b4d926c1ae1724ae86b24fc">&#9670;&#160;</a></span>TSCButton_manage_Interrupt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TSCButton_manage_Interrupt </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Call this function in the HAL-Interrupt handler to set an internal interrupt flag for the TSC module. </p>
<p>Here is an example: </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> HAL_TSC_ConvCpltCallback(TSC_HandleTypeDef* htsc)</div>
<div class="line">{</div>
<div class="line">  <a class="code hl_function" href="#ga9a0bf2ea0b4d926c1ae1724ae86b24fc">TSCButton_manage_Interrupt</a>();</div>
<div class="line">}</div>
<div class="ttc" id="agroup___t_s_c_button___header_html_ga9a0bf2ea0b4d926c1ae1724ae86b24fc"><div class="ttname"><a href="#ga9a0bf2ea0b4d926c1ae1724ae86b24fc">TSCButton_manage_Interrupt</a></div><div class="ttdeci">void TSCButton_manage_Interrupt(void)</div><div class="ttdoc">Call this function in the HAL-Interrupt handler to set an internal interrupt flag for the TSC module.</div><div class="ttdef"><b>Definition</b> tscButton.c:310</div></div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">none</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none </dd></dl>

</div>
</div>
<a id="ga503e1c587002f993ecfb62f6ad0209e4" name="ga503e1c587002f993ecfb62f6ad0209e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga503e1c587002f993ecfb62f6ad0209e4">&#9670;&#160;</a></span>TSCButton_start_All()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TSCButton_start_All </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function sets the module to start conditions. </p>
<dl class="section note"><dt>Note</dt><dd>This function must be called once before updating and after initialization. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">none</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none </dd></dl>
<p>1. set button current button index to 0</p>

</div>
</div>
<a id="gad583fc1b4a691826653bcb2dd5d52278" name="gad583fc1b4a691826653bcb2dd5d52278"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad583fc1b4a691826653bcb2dd5d52278">&#9670;&#160;</a></span>TSCButton_update_All()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TSCButton_update_All </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the TSC for all buttons. Calöl this funciton periodically in the main while loop. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">none</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none </dd></dl>
<p>1. Check if TSC is blocked.</p><ul>
<li>If yes: leave function</li>
</ul>
<p>2. Check it TSC is already running</p><ul>
<li>If not: start TSC</li>
</ul>
<p>3. Check if TSC was interrupted.</p><ul>
<li>If not: leave function</li>
</ul>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
