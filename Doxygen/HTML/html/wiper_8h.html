<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Diploma Thesis DAW-Controller: Button Matrix: E:/Diplomarbeit/F-STM_Workspace_DemoProjects/L053R8T6_DemoProject_MotorizedFader/Core/Inc/wiper.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="mdw_Logo_weiss.jpg"/></td>
  <td id="projectalign">
   <div id="projectname">Diploma Thesis DAW-Controller: Button Matrix<span id="projectnumber">&#160;Demo Project</span>
   </div>
   <div id="projectbrief">This Project shows how to setup and use a button matrix.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('wiper_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a>  </div>
  <div class="headertitle"><div class="title">wiper.h File Reference<div class="ingroups"><a class="el" href="group___motor_fader.html">Motorized Fader</a> &raquo; <a class="el" href="group___wiper_motor_fader.html">Wiper module</a> &raquo; <a class="el" href="group___wiper___header.html">Header</a></div></div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;stm32l0xx_hal.h&quot;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
</div>
<p><a href="wiper_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_wiper__struct_td.html">Wiper_structTd</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gaefaa9e5288b9ef7da21f894a38dcfbb5" id="r_gaefaa9e5288b9ef7da21f894a38dcfbb5"><td class="memItemLeft" align="right" valign="top">
#define&#160;</td><td class="memItemRight" valign="bottom"><b>NUM_ALL_ADC_CHANNELS</b>&#160;&#160;&#160;19</td></tr>
<tr class="memdesc:gaefaa9e5288b9ef7da21f894a38dcfbb5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of available ADC channels of the MCU. Change this value if the used MCU offers more channels. <br /></td></tr>
<tr class="separator:gaefaa9e5288b9ef7da21f894a38dcfbb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3c114292578f2c874fc0a04494864940" id="r_ga3c114292578f2c874fc0a04494864940"><td class="memItemLeft" align="right" valign="top">
#define&#160;</td><td class="memItemRight" valign="bottom"><b>NUM_ALL_ADC_ON_MCU</b>&#160;&#160;&#160;1</td></tr>
<tr class="memdesc:ga3c114292578f2c874fc0a04494864940"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of available ADCs (not ADC channels!) <br /></td></tr>
<tr class="separator:ga3c114292578f2c874fc0a04494864940"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3992a43fac1d452edf605ff497a25030" id="r_ga3992a43fac1d452edf605ff497a25030"><td class="memItemLeft" align="right" valign="top">
#define&#160;</td><td class="memItemRight" valign="bottom"><b>NUMBER_OF_SAMPLES</b>&#160;&#160;&#160;100</td></tr>
<tr class="memdesc:ga3992a43fac1d452edf605ff497a25030"><td class="mdescLeft">&#160;</td><td class="mdescRight">Define for the number of sampled values. If the smooth value is not clean enough, increase this number. Be careful that the ADC does not get to slow by using to many samples. <br /></td></tr>
<tr class="separator:ga3992a43fac1d452edf605ff497a25030"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader">Structures</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p>This structure is used to store all information about the used wiper. </p>
</div></td></tr>
<tr class="memitem:ga089384dc135a4b013a819353eb9d7801" id="r_ga089384dc135a4b013a819353eb9d7801"><td class="memItemLeft" align="right" valign="top">
typedef struct Wiper_structTd&#160;</td><td class="memItemRight" valign="bottom"><b>Wiper_structTd</b></td></tr>
<tr class="separator:ga089384dc135a4b013a819353eb9d7801"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader">Initialize</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p>Use these functions to initialize the wiper of the fader </p>
</div></td></tr>
<tr class="memitem:ga3769a4718f132d3298e7c6a9456667e9" id="r_ga3769a4718f132d3298e7c6a9456667e9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___wiper___header.html#ga3769a4718f132d3298e7c6a9456667e9">Wiper_init_ADC</a> (<a class="el" href="struct_wiper__struct_td.html">Wiper_structTd</a> *Wiper, ADC_HandleTypeDef *hadc)</td></tr>
<tr class="memdesc:ga3769a4718f132d3298e7c6a9456667e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Link HAL-ADC-handle used for wiper.  <br /></td></tr>
<tr class="separator:ga3769a4718f132d3298e7c6a9456667e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6ea4077964bf0c78ed5cb2e918fe07e7" id="r_ga6ea4077964bf0c78ed5cb2e918fe07e7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___wiper___header.html#ga6ea4077964bf0c78ed5cb2e918fe07e7">Wiper_init_Hysteresis</a> (<a class="el" href="struct_wiper__struct_td.html">Wiper_structTd</a> *Wiper)</td></tr>
<tr class="memdesc:ga6ea4077964bf0c78ed5cb2e918fe07e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set hysteresis settings to default.  <br /></td></tr>
<tr class="separator:ga6ea4077964bf0c78ed5cb2e918fe07e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Calibrate</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p>Use this function to calibrate the wiper</p>
<dl class="section note"><dt>Note</dt><dd>These functions are not essential, but may be helpful to improve the performance. </dd></dl>
<h1><a class="anchor" id="autotoc_md39"></a>
How to calibrate:</h1>
<h2><a class="anchor" id="autotoc_md40"></a>
Hardware (if possible):</h2>
<ul>
<li>make sure that the ADC is working with a clean Vref </li>
</ul>
<h2><a class="anchor" id="autotoc_md41"></a>
Software:</h2>
<ol type="1">
<li>Change HAL-Settings to get as close as possible to the preferred result. Where to adapt:<ul>
<li>HCLK (if it can be changed without affecting other components) and / or Prescaler to reduce clock of ADC</li>
<li>Sampling Time</li>
</ul>
</li>
<li>Change define of <a class="el" href="group___wiper___header.html#ga3992a43fac1d452edf605ff497a25030">NUMBER_OF_SAMPLES</a> until value is closer to the preferred result</li>
<li>Change hysteresis threshold to reduce noise</li>
<li>Change deviation threshold to get closer to the exact value inside the hysteresis range. </li>
</ol>
</div></td></tr>
<tr class="memitem:ga1e29bd553a21cdf0ceb9d3c14b45a755" id="r_ga1e29bd553a21cdf0ceb9d3c14b45a755"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___wiper___header.html#ga1e29bd553a21cdf0ceb9d3c14b45a755">Wiper_calibrate_HysteresisThreshold</a> (<a class="el" href="struct_wiper__struct_td.html">Wiper_structTd</a> *Wiper, uint8_t Threshold)</td></tr>
<tr class="memdesc:ga1e29bd553a21cdf0ceb9d3c14b45a755"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calibrate the hysteresis threshold.  <br /></td></tr>
<tr class="separator:ga1e29bd553a21cdf0ceb9d3c14b45a755"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab4493630c4a3361e1b45694ded6d1fe6" id="r_gab4493630c4a3361e1b45694ded6d1fe6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___wiper___header.html#gab4493630c4a3361e1b45694ded6d1fe6">Wiper_calibrate_HysteresisDeviationThreshold</a> (<a class="el" href="struct_wiper__struct_td.html">Wiper_structTd</a> *Wiper, uint8_t Threshold)</td></tr>
<tr class="memdesc:gab4493630c4a3361e1b45694ded6d1fe6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calibrate the Deviation Threshold. This will define, when the value will be corrected, if the value thrifts inside the hysteresis threshold.  <br /></td></tr>
<tr class="separator:gab4493630c4a3361e1b45694ded6d1fe6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Process ADC</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p>Use these functions to control the ADC </p>
</div></td></tr>
<tr class="memitem:ga98a7e3568b3c8c797e29f3178f370f52" id="r_ga98a7e3568b3c8c797e29f3178f370f52"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___wiper___header.html#ga98a7e3568b3c8c797e29f3178f370f52">Wiper_start_All</a> (void)</td></tr>
<tr class="memdesc:ga98a7e3568b3c8c797e29f3178f370f52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to start the ADC over DMA conversion. Call this function once when the ADC should start.  <br /></td></tr>
<tr class="separator:ga98a7e3568b3c8c797e29f3178f370f52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4520e2fb456df3472ea105accd8e29fe" id="r_ga4520e2fb456df3472ea105accd8e29fe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___wiper___header.html#ga4520e2fb456df3472ea105accd8e29fe">Wiper_update_All</a> (void)</td></tr>
<tr class="memdesc:ga4520e2fb456df3472ea105accd8e29fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Call this function periodically in while function to fill the wipers with samples from the DMA buffer.  <br /></td></tr>
<tr class="separator:ga4520e2fb456df3472ea105accd8e29fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5e2f11d13d6a2aabb6f4f5cd18a01966" id="r_ga5e2f11d13d6a2aabb6f4f5cd18a01966"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___wiper___header.html#ga5e2f11d13d6a2aabb6f4f5cd18a01966">Wiper_manage_Interrupt</a> (ADC_HandleTypeDef *hadc)</td></tr>
<tr class="memdesc:ga5e2f11d13d6a2aabb6f4f5cd18a01966"><td class="mdescLeft">&#160;</td><td class="mdescRight">Call this function in the HAL-Interrupt handler to set an internal interrupt flag for the wiper module.  <br /></td></tr>
<tr class="separator:ga5e2f11d13d6a2aabb6f4f5cd18a01966"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Get Functions</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p>Use these functions to get values from the Wiper </p>
</div></td></tr>
<tr class="memitem:ga2b14f1d1a5a0e563fcc51f48172778bf" id="r_ga2b14f1d1a5a0e563fcc51f48172778bf"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___wiper___header.html#ga2b14f1d1a5a0e563fcc51f48172778bf">Wiper_get_RawValue</a> (<a class="el" href="struct_wiper__struct_td.html">Wiper_structTd</a> *Wiper)</td></tr>
<tr class="memdesc:ga2b14f1d1a5a0e563fcc51f48172778bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Call this function to get the current raw ADC value from the DMA buffer.  <br /></td></tr>
<tr class="separator:ga2b14f1d1a5a0e563fcc51f48172778bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga124ac40da48f0c8394f841632409401a" id="r_ga124ac40da48f0c8394f841632409401a"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___wiper___header.html#ga124ac40da48f0c8394f841632409401a">Wiper_get_SmoothValue</a> (<a class="el" href="struct_wiper__struct_td.html">Wiper_structTd</a> *Wiper)</td></tr>
<tr class="memdesc:ga124ac40da48f0c8394f841632409401a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Call this function to get the smoothed value of the ADC.  <br /></td></tr>
<tr class="separator:ga124ac40da48f0c8394f841632409401a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section date"><dt>Date</dt><dd>Sep 4, 2023 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Mario Niehren </dd></dl>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_2ca9457e11c007c45320d7fe4fa38528.html">L053R8T6_DemoProject_MotorizedFader</a></li><li class="navelem"><a class="el" href="dir_09ca6776745baf78c78f0eb664d19039.html">Core</a></li><li class="navelem"><a class="el" href="dir_fca65bc9ab0a57364571c2fe8b677c75.html">Inc</a></li><li class="navelem"><a class="el" href="wiper_8h.html">wiper.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
